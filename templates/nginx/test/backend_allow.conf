location ~* ^/typo3/.*\.php$ {

        satisfy any;
        allow 159.103.207.208/28;
        allow 138.190.132.0/27;
        allow 80.123.196.122;
        allow 138.190.48.106;
        allow 172.17.0.4; 
        allow 138.190.133.0/27;
        allow 194.38.207.229;
        allow 194.38.207.228;
        allow 203.116.109.145;
        allow 203.116.109.146;
        allow 212.203.111.210;
        allow 212.243.228.247;
        allow 138.190.32.7;
        allow 193.223.49.96/27;
        deny all;
        auth_basic "Restricted Area";
        auth_basic_user_file /etc/nginx/conf.d/custom/.htpasswd;

        fastcgi_param   TYPO3_CONTEXT    "Production/TEST"; #"Development";
        fastcgi_param   FLOW_CONTEXT      "Production/TEST";
        fastcgi_param   FLOW_REWRITEURLS  1;

        # taakuth5/set read_timeout to 180 for BJBGW-194 according to 
        # stackoverflow.com/questions/16002268/prevent-nginx-504-gateway-timeout-using-php-set-time-limit
        fastcgi_read_timeout 180s;

        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass phpfpm:9000;

        fastcgi_param   SCRIPT_FILENAME   $request_filename;

        include fastcgi_params;
}
